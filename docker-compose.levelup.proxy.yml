services:
  proxy:
    image: caddy:2.8-alpine
    container_name: visor-levelup-proxy
    env_file:
      - .levelup.env
    volumes:
      - /root/code/visor/data/levelups/proxy/Caddyfile.autogen:/etc/caddy/Caddyfile:ro
      - /root/code/visor/data/levelups/proxy/data:/data
      - /root/code/visor/data/levelups/proxy/config:/config
    ports:
      - 127.0.0.1:${PROXY_HTTP_PORT:-80}:80
      - 127.0.0.1:${PROXY_HTTPS_PORT:-443}:443
    networks:
      - proxy
      - levelup-cloudflared
      - levelup-echo-stub
      - levelup-forgejo
      - levelup-himalaya
      - levelup-obsidian
    restart: unless-stopped

networks:
  proxy:
    name: visor-proxy
  levelup-cloudflared:
    name: visor-levelup-cloudflared
  levelup-echo-stub:
    name: visor-levelup-echo-stub
  levelup-forgejo:
    name: visor-levelup-forgejo
  levelup-himalaya:
    name: visor-levelup-himalaya
  levelup-obsidian:
    name: visor-levelup-obsidian
